(function(g){function n(h,b,i,j){var e=g(h).data("originalFragments"),c=0,f,d=function(){c+=1;c===e.length&&j()};for(f=0;f<e.length;++f)h=e[f],g("#"+h.id).fadeTo(b,i,d)}function p(h,b,i,j,e){var c=g(b),f=c.data("originalFragments"),d=0,k,l,a,m=function(){d+=1;d===f.length&&(c.css("visibility","hidden"),e())};for(a=0;a<f.length;++a){b=f[a];k=b.left;l=b.top;switch(Math.floor(4*Math.random())+0){case 0:k=-b.width;break;case 1:k=i;break;case 2:l=-b.height;break;case 3:l=j}g("#"+b.id).delay(a*h).animate({left:k,
top:l},750,m)}}g.fn.slideandfade=function(h,b){var i,j,e,c=g.extend({callback:function(){}},b);return this.each(function(){function b(e,h){var c=a.currentDisplayBox,d=function(){var b=g(e),c=b.data("originalFragments"),d=0,f,i=function(){d+=1;d===c.length&&n(e,250,1,function(){a.busy=!1;h()})};b.css("visibility","visible");for(f=0;f<c.length;++f)b=c[f],g("#"+b.id).delay(100*f).animate({left:b.left,top:b.top},750,i)};a.currentDisplayBox=e;n(c,250,0.2,function(){p(100,c,k,l,d)})}var d=g(this),k=d.width(),
l=d.height(),a=d.data("nspace"),m;void 0===a&&(m=g(".displayBox",this),a={currentDisplayBox:m[0],busy:!1,haveScatteredFragments:!1,displayBoxes:m},d.data("nspace",a),a.displayBoxes.each(function(){var a=g(this),b=[];a.children(".fragment").each(function(a){var c=g(this),d={};d.id=c.attr("id");d.width=c.width();d.height=c.height();d.top=c.position().top;d.left=c.position().left;b[a]=d});a.data("originalFragments",b)}));if(!a.busy)if(a.busy=!0,!a.haveScatteredFragments||void 0===h){a.haveScatteredFragments=
!0;i=0;j=function(){++i;i===2*a.displayBoxes.length&&(void 0===h?(a.busy=!1,c.callback()):b(h,c.callback))};for(e=0;e<a.displayBoxes.length;++e)p(0,a.displayBoxes[e],k,l,j),n(a.displayBoxes[e],0,0.2,j)}else b(h,c.callback)})}})(jQuery);
